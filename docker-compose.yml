version: "3"

services:
  # application Flask server
  server:
    container_name: mender_www
    restart: unless-stopped

    ports:
      - "8000:8000"

    build:
      context: .

    logging:
      driver: "json-file"
      options:
        max-size: "100k"
        max-file: "10"


  # reverse-proxy NGINX server
  web:
    image: "nginx"
    container_name: mender_nginx
    restart: on-failure

    logging:
      driver: "json-file"
      options:
        max-size: "100k"
        max-file: "10"

    ports:
      - "80:80"

    volumes:
      - ./conf/nginx.conf:/etc/nginx/nginx.conf:ro
      - ./conf/mime.types:/etc/nginx/conf.d/mime.types:ro
